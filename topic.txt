nano ~/.kube/config
kubectl config view
kubectl cluster-info
kubectl config current-context
kubectl config get-contexts
kubectl config use-context gke_${DEVSHELL_PROJECT_ID}_us-central1_autopilot-cluster-1

Pods Commands
kubectl exec -it new-nginx -- /bin/bash
kubectl port-forward new-nginx 10081:80
curl http://127.0.0.1:10081/test.html
source <(kubectl completion bash)
kubectl cp ~/test.html $my_nginx_pod:/usr/share/nginx/html/test.html


https://docs.honeycomb.io/manage-data-volume/refinery/set-up/


sudo apt-get update
sudo apt-get install apt-transport-https gnupg lsb-release
curl https://baltocdn.com/helm/signing.asc | sudo apt-key add -
echo "deb https://baltocdn.com/helm/stable/debian/ all main" | sudo tee /etc/apt/sources.list.d/helm-stable-debian.list
sudo apt-get update
sudo apt-get install helm


gcloud config set project corp-test-mgmt-anthos-3578
gcloud container fleet memberships get-credentials non-prod-ecommerce-internal
helm repo add honeycomb https://honeycombio.github.io/helm-charts
helm repo update refinery honeycomb/refinery
helm repo update refinery honeycomb/refinery
helm repo update refinery honeycomb
helm repo update honeycomb
helm repo update
helm list -A
helm search repo honeycomb
helm install honeycomb-refinery honeycomb/refinery --namespace honeycomb
kubectl create namespace honeycomb
kubectl get ns


 
     
# New Step 4: Retag the top 5 most recent images as rollback-image-date
- name: Retag Top 5 Most Recent Images as Rollback
  run: |
    echo "Starting retagging process..."

    FULL_IMAGE_NAME="${{ env.REGISTRY_HOST }}/${{ env.PROJECT_ID }}/${{ env.REPOSITORY }}/${{ env.IMAGE_NAME }}"
    echo "Full image name: $FULL_IMAGE_NAME"

    DATE_TAG=$(date +%Y%m%d%H%M%S)
    echo "Generated date tag: $DATE_TAG"

    echo "Fetching all image tags..."
    ALL_TAGS=$(gcloud artifacts docker images list $FULL_IMAGE_NAME --format='value(tags)' --limit=10 | tr ',' '\n' | sort -r | grep -v "^${{ inputs.DOCKER_IMAGE_TAG }}$")
    echo "Fetched tags, excluding the latest: $ALL_TAGS"

    COUNT=0

    for TAG in $ALL_TAGS; do
        if [ $COUNT -lt 5 ]; then
            echo "Processing tag #$COUNT: $TAG"
            NEW_TAG="rollback-image-$DATE_TAG-$COUNT" # Use COUNT to differentiate between rollback tags
            echo "New tag will be: $NEW_TAG"

            echo "Tagging $FULL_IMAGE_NAME:$TAG as $FULL_IMAGE_NAME:$NEW_TAG"
            docker tag $FULL_IMAGE_NAME:$TAG $FULL_IMAGE_NAME:$NEW_TAG

            echo "Pushing $FULL_IMAGE_NAME:$NEW_TAG"
            docker push $FULL_IMAGE_NAME:$NEW_TAG

            echo "Tagged and pushed: $FULL_IMAGE_NAME:$NEW_TAG"
            let COUNT=COUNT+1
        else
            echo "Reached limit of 5 tags, stopping."
            break # Stop the loop after tagging the top 5
        fi
    done

    echo "Retagging process completed."
